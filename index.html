<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Building 3 — Unified Checker</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="container">
    <h1>Building 3 Questionnaire</h1>
    <p class="subtitle">Answer all questions and click “Check Answers”. Get them all right to be redirected.</p>
</header>

<main class="container">
    <!-- Unified form -->
    <form id="quiz-form" class="qa-form" novalidate>
        <section class="card" aria-labelledby="b3-title">
            <h2 id="b3-title">Building 3</h2>

            <!-- Q1 -->
            <fieldset class="q">
                <legend>1) Which facility is most associated with <strong>Building 3</strong>?</legend>
                <div class="choices">
                    <label><input type="radio" name="b3-facility" value="Learning Commons"> Learning Commons</label>
                    <label><input type="radio" name="b3-facility" value="Science Labs"> Science Labs</label>
                    <label><input type="radio" name="b3-facility" value="Cafeteria"> Cafeteria</label>
                    <label><input type="radio" name="b3-facility" value="Computer Labs"> Computer Labs</label>
                </div>
            </fieldset>

            <!-- Q2 -->
            <fieldset class="q">
                <legend>2) What is the room number of the <strong>Communication Tutor Center</strong>?</legend>
                <input id="b3-ctc" name="b3-ctc" type="text" inputmode="numeric" placeholder="Type the room number here" required />
            </fieldset>

            <!-- Q3 -->
            <fieldset class="q">
                <legend>3) What is located on <strong>Floor 5</strong>? (Select all that apply)</legend>
                <div class="choices grid">
                    <label><input type="checkbox" name="b3-floor5" value="Tutoring Lab"> Tutoring Lab</label>
                    <label><input type="checkbox" name="b3-floor5" value="Counseling Center"> Counseling Center</label>
                    <label><input type="checkbox" name="b3-floor5" value="Library"> Library</label>
                    <label><input type="checkbox" name="b3-floor5" value="MESA"> MESA</label>
                    <label><input type="checkbox" name="b3-floor5" value="Professor's Office"> Professor's Office</label>
                </div>
            </fieldset>

            <!-- Q4 -->
            <fieldset class="q">
                <legend>4) Where can you get the keys for private study rooms in <strong>Floor 4</strong>?</legend>
                <div class="choices">
                    <label><input type="radio" name="b3-keys" value="Library Front Desk"> Library Front Desk</label>
                    <label><input type="radio" name="b3-keys" value="Tutoring Center Faculty"> Tutoring Center Faculty</label>
                    <label><input type="radio" name="b3-keys" value="Ohlone Student Life"> Ohlone Student Life</label>
                    <label><input type="radio" name="b3-keys" value="Professor's Office"> Professor's Office</label>
                </div>
            </fieldset>

            <!-- Q5 -->
            <fieldset class="q">
                <legend>5) What are some things that <strong>MESA</strong> offers? (Select all that apply)</legend>
                <div class="choices grid">
                    <label><input type="checkbox" name="b3-mesa" value="Free food and drinks!"> Free food and drinks!</label>
                    <label><input type="checkbox" name="b3-mesa" value="Internship opportunities"> Internship opportunities</label>
                    <label><input type="checkbox" name="b3-mesa" value="Academic Assist"> Academic Assist</label>
                    <label><input type="checkbox" name="b3-mesa" value="STEM-Oriented Counseling"> STEM-Oriented Counseling</label>
                </div>
            </fieldset>

            <!-- Actions -->
            <div class="actions">
                <button id="checkAll" type="submit" class="btn">Check Answers</button>
                <button type="button" class="btn ghost" id="resetAll">Reset</button>
            </div>
        </section>
    </form>

    <section class="card" aria-labelledby="results-title">
        <h2 id="results-title">Results</h2>
        <output id="results" class="output" aria-live="polite"></output>
    </section>
</main>

<footer class="container footer">
    <small>All checking is done locally in your browser.</small>
</footer>

<script>
    // ---------- helpers ----------
    function collectForm(formEl) {
        const data = {};
        const fd = new FormData(formEl);
        for (const [name, value] of fd.entries()) {
            if (data[name]) {
                if (Array.isArray(data[name])) data[name].push(value);
                else data[name] = [data[name], value];
            } else {
                data[name] = value;
            }
        }
        formEl.querySelectorAll('input[type="checkbox"]').forEach(cb => {
            if (!fd.has(cb.name)) data[cb.name] = [];
        });
        return data;
    }
    function sameSet(a = [], b = []) {
        const A = [...a].sort(); const B = [...b].sort();
        return JSON.stringify(A) === JSON.stringify(B);
    }

    // ---------- correct answers ----------
    const correct = {
        "b3-facility": "Computer Labs",
        "b3-ctc": "3418",
        "b3-floor5": ["Tutoring Lab","Library","MESA"],
        "b3-keys": "Library Front Desk",
        "b3-mesa": [
            "Free food and drinks!",
            "Internship opportunities",
            "Academic Assist",
            "STEM-Oriented Counseling"
        ]
    };

    // ---------- redirect ----------
    const REDIRECT_URL = "https://keysandgates.netlify.app/";

    // ---------- checker ----------
    function allAnswersCorrect(ans) {
        const q1 = (ans["b3-facility"] || "").toLowerCase() === correct["b3-facility"].toLowerCase();
        const q2 = (ans["b3-ctc"] || "").trim() === correct["b3-ctc"];
        const q3 = sameSet(ans["b3-floor5"] || [], correct["b3-floor5"]);
        const q4 = (ans["b3-keys"] || "") === correct["b3-keys"];
        const q5 = sameSet(ans["b3-mesa"] || [], correct["b3-mesa"]);
        return q1 && q2 && q3 && q4 && q5;
    }

    // ---------- wire up ----------
    const form = document.getElementById("quiz-form");
    const results = document.getElementById("resul
